06/11 [13:50:24] [34mINFO    [39m | >> [1m[[22m*[1m][22m      ]8;id=588481;file:///data2/xxw_data/projects/LLM/Diffusive-Latent-CoT/training/strategies/train_coconut_with_preprocessed_embeddings.py\train_coconut_with_preprocessed_embeddings.py]8;;\:]8;id=972341;file:///data2/xxw_data/projects/LLM/Diffusive-Latent-CoT/training/strategies/train_coconut_with_preprocessed_embeddings.py#233\233]8;;\
                          Starting
                          Epoch [1m1[22m/[1m30
train_idx is: 0
Step 1/240, Epoch 1/30 (LogEpoch: 0), Loss: 458.0254, LR: 0.000100
global_step is: 1; target_steps is: 240
train_idx is: 1
Step 2/240, Epoch 1/30 (LogEpoch: 0), Loss: 472.0889, LR: 0.000100
global_step is: 2; target_steps is: 240
train_idx is: 2
Step 3/240, Epoch 1/30 (LogEpoch: 0), Loss: 446.3219, LR: 0.000100
global_step is: 3; target_steps is: 240
train_idx is: 3
Step 4/240, Epoch 1/30 (LogEpoch: 0), Loss: 485.4766, LR: 0.000100
global_step is: 4; target_steps is: 240
train_idx is: 4
Step 5/240, Epoch 1/30 (LogEpoch: 0), Loss: 468.4612, LR: 0.000100
global_step is: 5; target_steps is: 240
train_idx is: 5
Step 6/240, Epoch 1/30 (LogEpoch: 0), Loss: 471.8342, LR: 0.000100
global_step is: 6; target_steps is: 240
train_idx is: 6
Step 7/240, Epoch 1/30 (LogEpoch: 0), Loss: 440.5450, LR: 0.000100
global_step is: 7; target_steps is: 240
train_idx is: 7
Step 8/240, Epoch 1/30 (LogEpoch: 1), Loss: 437.7954, LR: 0.000100
global_step is: 8; target_steps is: 240
06/11 [13:55:09] [34mINFO    [39m | >> [1m[[22m*[1m][22m      ]8;id=272792;file:///data2/xxw_data/projects/LLM/Diffusive-Latent-CoT/training/strategies/train_coconut_with_preprocessed_embeddings.py\train_coconut_with_preprocessed_embeddings.py]8;;\:]8;id=494050;file:///data2/xxw_data/projects/LLM/Diffusive-Latent-CoT/training/strategies/train_coconut_with_preprocessed_embeddings.py#327\327]8;;\
                          DEBUG: End of
                          epoch_idx [1m0[22m.
                          Current
                          global_step =
                          [1m8[22m,
                          target_steps
                          = [1m240
                 [34mINFO    [39m | >> [1m[[22m*[1m][22m      ]8;id=900021;file:///data2/xxw_data/projects/LLM/Diffusive-Latent-CoT/training/strategies/train_coconut_with_preprocessed_embeddings.py\train_coconut_with_preprocessed_embeddings.py]8;;\:]8;id=450827;file:///data2/xxw_data/projects/LLM/Diffusive-Latent-CoT/training/strategies/train_coconut_with_preprocessed_embeddings.py#233\233]8;;\
                          Starting
                          Epoch [1m2[22m/[1m30
train_idx is: 0
Step 9/240, Epoch 2/30 (LogEpoch: 1), Loss: 448.3088, LR: 0.000100
global_step is: 9; target_steps is: 240
train_idx is: 1
Step 10/240, Epoch 2/30 (LogEpoch: 1), Loss: 422.5930, LR: 0.000100
global_step is: 10; target_steps is: 240
train_idx is: 2
Step 11/240, Epoch 2/30 (LogEpoch: 1), Loss: 411.0798, LR: 0.000100
global_step is: 11; target_steps is: 240
train_idx is: 3
Step 12/240, Epoch 2/30 (LogEpoch: 1), Loss: 370.9855, LR: 0.000100
global_step is: 12; target_steps is: 240
train_idx is: 4
Step 13/240, Epoch 2/30 (LogEpoch: 1), Loss: 370.8085, LR: 0.000100
global_step is: 13; target_steps is: 240
train_idx is: 5
Training DiffusiveCoT with Preprocessed Embeddings:   0%|        | 0/240 [00:00<?, ?it/s]2025-06-11 13:50:31.220485: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:50:31.220536: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:50:31.221622: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:50:31.228040: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:50:32.071400: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:50:33.131232: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2025-06-11 13:50:44.069012: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:50:44.069069: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:50:44.070207: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:50:44.076917: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:50:44.947885: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:50:46.194476: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2025-06-11 13:50:57.227289: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:50:57.227344: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:50:57.228394: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:50:57.234698: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:50:58.035203: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:50:59.216696: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2025-06-11 13:51:09.949778: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:51:09.949833: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:51:09.951061: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:51:09.957729: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:51:10.803252: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:51:11.864870: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Training DiffusiveCoT with Preprocessed Embeddings:   3%| | 8/240 [04:43<1:56:29, 30.13s/2025-06-11 13:55:12.963175: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:55:12.963226: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:55:12.964267: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:55:12.970652: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:55:13.771530: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:55:14.784622: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2025-06-11 13:55:25.504044: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:55:25.504097: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:55:25.505245: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:55:25.511782: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:55:26.232512: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:55:27.337223: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2025-06-11 13:55:37.667293: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:55:37.667347: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:55:37.668712: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:55:37.675404: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:55:38.410673: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:55:39.452627: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2025-06-11 13:55:50.239417: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-11 13:55:50.239477: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-11 13:55:50.240811: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-11 13:55:50.248377: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-11 13:55:51.139865: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-11 13:55:52.483675: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Training DiffusiveCoT with Preprocessed Embeddings:   5%| | 13/240 [07:56<1:59:14, 31.52sException ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f409b6e2f80>
Traceback (most recent call last):
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1604, in __del__
    self._shutdown_workers()
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1568, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Process SpawnProcess-2:
Traceback (most recent call last):
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 317, in _bootstrap
    util._exit_function()
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/util.py", line 357, in _exit_function
    p.join()
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/popen_fork.py", line 43, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 330, in _bootstrap
    traceback.print_exc()
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 179, in print_exc
    print_exception(*sys.exc_info(), limit=limit, file=file, chain=chain)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 119, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 502, in __init__
    self.stack = StackSummary.extract(
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 383, in extract
    f.line
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 306, in line
    self._line = linecache.getline(self.filename, self.lineno)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
  File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/tokenize.py", line 394, in open
    buffer = _builtin_open(filename, 'rb')
KeyboardInterrupt
[rank1]: Traceback (most recent call last):
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 317, in _bootstrap
[rank1]:     util._exit_function()
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/util.py", line 357, in _exit_function
[rank1]:     p.join()
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 149, in join
[rank1]:     res = self._popen.wait(timeout)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/popen_fork.py", line 43, in wait
[rank1]:     return self.poll(os.WNOHANG if timeout == 0.0 else 0)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/popen_fork.py", line 27, in poll
[rank1]:     pid, sts = os.waitpid(self.pid, flag)
[rank1]: KeyboardInterrupt
[rank1]: During handling of the above exception, another exception occurred:
[rank1]: Traceback (most recent call last):
[rank1]:   File "<string>", line 1, in <module>
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
[rank1]:     exitcode = _main(fd, parent_sentinel)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
[rank1]:     return self._bootstrap(parent_sentinel)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/multiprocessing/process.py", line 330, in _bootstrap
[rank1]:     traceback.print_exc()
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 179, in print_exc
[rank1]:     print_exception(*sys.exc_info(), limit=limit, file=file, chain=chain)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 119, in print_exception
[rank1]:     te = TracebackException(type(value), value, tb, limit=limit, compact=True)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 502, in __init__
[rank1]:     self.stack = StackSummary.extract(
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 383, in extract
[rank1]:     f.line
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/traceback.py", line 306, in line
[rank1]:     self._line = linecache.getline(self.filename, self.lineno)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/linecache.py", line 30, in getline
[rank1]:     lines = getlines(filename, module_globals)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/linecache.py", line 46, in getlines
[rank1]:     return updatecache(filename, module_globals)
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/linecache.py", line 136, in updatecache
[rank1]:     with tokenize.open(fullname) as fp:
[rank1]:   File "/data2/xxw_data/data/miniconda3/envs/hybridvla/lib/python3.10/tokenize.py", line 394, in open
[rank1]:     buffer = _builtin_open(filename, 'rb')
[rank1]: KeyboardInterrupt